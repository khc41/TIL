## 📅 2025-03-18
### 📖 읽은 블로그: [서버 증설 없이 처리하는 대규모 트래픽](https://toss.tech/article/monitoring-traffic)
#### ✏️ 요약
- 트래픽이 급격하게 늘어나면 스레드, 캐시, 데이터베이스, 애플리케이션 등 여러곳에서 부하가 발생할 수 있는데, 단순히 서버 증설만으로는 특정 시점에 몰리는 트래픽을 비용효율적으로 해결할 수 없다.
- Redis의 과부하가 생겨 먼저 캐싱 데이터를 Universal Data와 User-Specific Data로 분리해, Universal Data는 Local Cache를 사용해 문제를 해결했고, User-Specific Data는 데이터를 저장할 때 다양한 압축 방법을 활용해 데이터 크기를 최소화해 문제를 해결했다.
- 선착순 포인트 지급에서는 Distributed Lock을 걸어 API 요청이 연속으로 2번 호출되는 것을 방지하고, Redis의 하나의 키에 Append해 중복을 제거했다. 또한, Kafka를 이용해 비동기로 Insert하고 Consumer에서 Throttling을 걸어 최대 QPS에 닿지 않도록 조절해 문제를 해결했다.
- API를 최적화하기 위해 중복 요청을 제거하고 여러 API를 하나로 합쳐서 피크 트래픽의 규모를 줄일 수 있었다.
- 서버 모니터링 / 문제점 파악 / 해결책 제안 및 적용 / 카나리 배포 후 서버 모니터링 네 가지 방법을 이터레이션 해서 성능을 개선하고 있다.
- 모니터링은 서버를 포함한 각 컴포넌트(Redis, DB, Kafka 등)와 서비스 지표(PV, UV, 리텐션 등)을 실시간으로 모니터링 해야한다.
#### 💡 느낀 점
- 서버 모니터링이 성능 개선에서 중요하다는 것을 배웠다.
- 현재 실무에서는 API 속도의 문제로 화면에 맞추어 API를 한번에 응답하는 것을 지양하고 분리하는 추세로 가고 있는데, 서버 트래픽이 몰리면 부하에 영향이 있어 통합하는 과정에서 상황에 따라 API를 통합 / 분리하는 것도 다르구나라고 느꼈다.
- 백엔드 개발자는 비즈니스에 맞춘 단순한 API 개발도 중요하지만, 대규모 트래픽 대응해 API나 서비스를 개발하는 것이 더더욱 중요하다고 느꼈다.
