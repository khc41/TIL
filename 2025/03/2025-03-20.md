## 📅 2025-03-20
### 🎥 시청한 컨퍼런스 영상: [신뢰성 있는 카프카 애플리케이션을 만드는 3가지 방법 (최원영 Cory)](https://www.youtube.com/watch?v=7_VdIFH6M6Q)
#### ✏️ 요약
- 메시지 전달 신뢰성에는 정확히 한 번, 적어도 한 번, 최대 한 번이 있는데, 카프카를 사용하면서 다양한 비즈니스에 맞춰 신뢰성을 보장해야한다.
- 프로듀서에서 전달한 Acknowledgement가 네트워크 상에서 유실이 되면 레코드의 중복 적재가 발생한다. 이를 해결하기 위해 멱등성 프로듀서 옵션을 사용하면, 각각의 레코드에 대해 PID와 시퀀스 넘버를 함께 전달해 문제를 해결한다. kafka 3.0 이후 부터는 자동으로 설정이 된다.
- 토픽을 컨슘해서 이벤트를 다른 토픽으로 전달하는 애플리케이션에서 장애가 발생하면 다른 컨슈머에서 중복이 발생할 수 있다. 이를 해결하기 위해 트랜잭션 컨슈머와 프로듀서를 사용해 원자성을 보장해줘서 문제를 해결한다.
- 토픽을 컨슘해서 데이터베이스에 적재할 때 컨슈머의 중복 적재가 발생할 수 있다. 이를 해결하기 위해 유니크 키를 활용하거나, upsert, write-ahead log를 활용해 문제를 해결한다.
#### 💡 느낀 점
- 실제 kafka를 사용할 때 다양한 장애가 발생할 수 있는 것을 배웠고, 이런 이유 때문에 kafka를 사용하는 것이 중요한 게 아니라 kafka를 어떻게 운영하고 어떤식으로 장애대응을 할 것인지가 중요한 것이라고 느꼈다.
- 마지막에 처음에 말했던 신뢰성의 세가지 항목에 대해서 모든 항목을 지킬 필요는 없고, 비즈니스에 맞춰서 선택 적용하라는 말을 해주셨는데 이 부분에서 실무 상황에 맞춰 유동적으로 개발하는 것이 중요하다고 느꼈다.
- WAL 이란 개념을 처음 들어봤는데, DB 반영 전 로그를 남기고 장애가 나면 로그를 복구한다는 소프트웨어 방법론이 있다는 사실을 배웠다.