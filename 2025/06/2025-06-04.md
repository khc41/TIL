## 📅 2025-06-04
### 📚 읽은 개발 서적: [가상면접 사례로 배우는 대규모 시스템 설계 기초](https://product.kyobobook.co.kr/detail/S000001033116)
#### ✏️ 1장 요약
#### 비관계형 데이터베이스
- 비관계형 데이터베이스를 선택해야하는 경우
  - 아주 낮은 응답 지연시간이 요구됨
  - 다루는 데이터가 비정형이라 관계형 데이터가 아님
  - 데이터를 직렬화하거나 역직렬화할 수 있기만 하면 됨
  - 아주 많은 양의 데이터를 저장할 필요가 있음
#### 관계형 데이터베이스
- 관계형 데이터베이스는 주-부 다중화 모델을 통해 성능을 개선할 수 있다.
  - 주 데이터베이스 서버에서만 쓰기 작업을 수행하고 부 데이터베이스에서는 읽기 작업만 수행해서 병렬로 처리될 수 있는 질의가 늘어나므로 성능이 좋아진다.
  - 안정성과 가용성이 높아진다.
#### 캐시와 CDN
- 캐시를 통해 응답시간을 개선할 수 있다.
  - 데이터베이스 부하를 줄일 수 있고, 캐시 계층의 규모를 독립적으로 확장시키는 것도 가능해진다.
- 캐시 사용시 유의사항
  - 데이터 갱신은 자주 일어나지 않지만 참조는 빈번하게 일어날 경우 사용한다.
  - 영속적으로 보관할 데이터는 캐시에 보관하지 않는다.
  - 만료 정책을 마련해둬야한다.
  - 데이터 저장소와 일관성을 고려해야 한다.
  - 캐시 서버를 한대만 둘 경우 SPOF가 발생할 수 있으므로 다중화해야 한다.
  - 캐시 메모리가 부족할 경우 데이터가 캐시에서 자주 밀려나서 캐시의 성능이 떨어지게 된다.
  - 데이터 방출 정책을 정해야한다.
- CDN으로 정적 콘텐츠의 응답시간을 개선할 수 있다.
- CDN 사용 시 고려사항
  - CDN은 데이터 전송 양에 따라 요금을 내게 되므로, 자주 사용되지 않는 콘텐츠는 CDN에 저장하지 않는 것이 좋다.
  - 시의성이 중요한 콘텐츠는 만료 시점을 잘 설정해야 한다.
  - CDN이 죽었을 경우 웹사이트/애플리케이션이 어떻게 동작해야 하는지 고려해야 한다.
  - 버저닝과 API를 통해 만료되지 않은 콘텐츠를 제거할 수 있다.
#### 무상태 웹 계층
- 무상태 웹 계층을 통해 규모 확장성을 높일 수 있다.
#### 다중 데이터 센터
- 여러 데이터 센터를 지원해 가용성을 높이고 어디서도 쾌적하게 사용할 수 있다.
- 다중 데이터센터 아키텍처를 만들려면 기술적 난제를 해결해야 한다.
  - 트래픽 우회
  - 데이터 동기화
  - 테스트와 배포
#### 메시지 큐
- 메시지 큐를 이용해 시스템의 각 컴포넌트를 분리하고 각기 독립적으로 확장시킬 수 있게 한다.
  - 서비스 또는 서버 간 결합이 느슨해져서 규모 확장성이 보장되어야 하는 안정적 애플리케이션을 구성하기 좋다.
#### 로그, 메트릭, 자동화
- 사업 규모가 커지면 로그, 메트릭, 자동화가 필수이다.
- 메트릭
  - 호스트 단위 메트릭: CPU, 메모리, 디스크 I/O에 관한 메트릭
  - 종합 메트릭: 데이터베이스 계층의 성능, 캐시 계층의 성능
  - 핵심 비즈니스 메트릭: 일별 능동 사용자, 수익, 재방문 등
- 자동화
  - 빌드, 테스트, 배포등의 절차를 자동화해 개발 생산성을 크게 향상시킬 수 있다.
#### 데이터베이스 확장
- 데이터베이스 수직적 확장은 하드웨어 무한증설 문제, 비용 문제, SPOF 문제로 인해 한계가 있다.
- 데이터베이스 수평적 확장은 샤딩이라고 부르는데, 샤드라는 작은 단위로 분할해 여러 데이터베이스에 나누어 데이터를 저장한다.
- 샤딩 전략을 구현할 때 가장 중요한 것은 샤딩 키를 정하는 방식이고 데이터를 고르게 분할 할 수 있도록 하는 게 가장 중요하다.
- 샤딩을 도입하면 새로운 문제들이 생긴다.
  - 데이터의 재 샤딩: 데이터가 너무 많아지거나 샤드간 데이터 분포가 균등하지 못할 때 해야한다.
  - 유명인사 문제: 핫스팟 키 문제라고도 부르는데, 특정 샤드에 질의가 집중되어 서버에 과부하가 걸리는 문제이다.
  - 조인과 비정규화: 여러 샤드에 걸친 데이터를 조인하기가 힘들어져서 데이터를 비정규화해 하나의 테이블에서 질의가 수행될 수 있도록 한다.
#### 💡 느낀 점
- 대규모 시스템을 설계하려면 많은 부분에서 다양한 기술들이 사용되는 것을 느꼈고, 그 기술들을 적용하면서 트레이드 오프나 발생할 수 있는 문제들에 대해서도 잘 알아야겠다고 생각했다.
- 기술 블로그를 꾸준히 읽는 습관을 들인 덕분에 이 책에서 다루는 기술들에 대해 어느정도 알 수 있었다.
- 아직 안해본 것들이 많은데 실습을 통해 부족한 부분을 채워야할 것이라고 생각됐다.