## 📅 2025-11-03
### 📖 읽은 블로그: [Server-Sent Events로 실시간 알림 전달하기](https://techblog.woowahan.com/23199/)
#### ✏️ 요약
- 기존 알림 전송 방식은 Zero Payload 형식의 메시지 전달, 보안, 네트워크 방화벽 차단, Webview 연결 불가 등의 문제가 있었다.
- AWS IoT를 도입해 메시지 보안을 강화하고, 정형화된 메시지 형식을 제공했다.
- 기존 아키텍쳐와 정합성과 서버에서 클라이언트로의 알림 전달이 핵심인 사용사례를 통해 WebSocket 대신 Server-Sent-Events(SSE)를 활용해 서버에서 클라이언트의 단방향 푸시를 구현해 나머지 문제를 해결했다.
  - 메시지 전달 아키텍쳐는 브로커가 모든 SSE 서버에 메시지를 전달하는 방식으로 Auto Scaling에 유연하게 대응하고, 메시지 순서 및 유실 방지하며, 느슨한 결합의 장점이 있다.
- 한 번 연결된 이후로부터는 마지막으로 수신했던 ID를 헤더에 포함해 메시지 유실을 방지했다.
- Session ID 기반으로 활성 세션을 관리하고 새로운 연결 시 기존 연결을 자동으로 종료함으로써 중복 연결을 방지했다.
- 무조건 전달돼야하는 중요한 이벤트는 CommitEvent라고 정의하고, commitUrl을 넣어 클라이언트가 이벤트를 수신하면 해당 URL을 호출하게 해 수신처리를 하고, 비즈니스 로직을 고려해 유효한 미수신 이벤트만 재전송하게 만들었다.
- 클라이언트 -> 서버 -> 외부 서버를 주기적으로 호출하던 것을 서버 -> 외부 서버만 호출되도록 해서 네트워크 비용을 크게 줄였다.
- Thundering Herd 문제를 해결하기 위해 random의 jitter를 추가해서 세션 연결의 부하를 분산히켰다.
#### 💡 느낀 점
- CommitEvent 방식은 인상깊었다. 중요한 이벤트에 대해 클라이언트 측에서 확인할 수 있게 별도로 처리하는 방식이 신뢰성을 높이는 좋은 방법인 것 같다.
- 메시지 전달 아키텍쳐에서 다양한 아키텍쳐들의 트레이드 오프를 현 상황에 맞게 잘 고려한 것 같다.