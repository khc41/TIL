## 📅 2026-01-27
### 📚 읽은 개발 서적: [데이터 중심 애플리케이션 설계](https://www.yes24.com/Product/Goods/59566585?pid=123487&cosemkid=go16406746660905354&utm_source=google_pc&utm_medium=cpc&utm_campaign=book_pc&utm_content=ys_240530_google_pc_cc_book_pc_12110%EB%8F%84%EC%84%9C2&utm_term=%EB%8D%B0%EC%9D%B4%ED%84%B0%EC%A4%91%EC%8B%AC%EC%95%A0%ED%94%8C%EB%A6%AC%EC%BC%80%EC%9D%B4%EC%85%98%EC%84%A4%EA%B3%84&gad_source=1&gad_campaignid=6762605740&gbraid=0AAAAAD79Irrfvaqb4HDi15JUqflihSilR&gclid=Cj0KCQjw3aLHBhDTARIsAIRij5-GpSKsMKO8XIATcjMBStXbk-93KGuGTmn0kK3NAbsbDtX417fNAIUaAih4EALw_wcB)
#### 2장. 데이터 모델과 질의 언어
- 데이터 모델은 문제를 어떻게 생각해야 하는지에 대해서 지대한 영향을 끼친다.
- 복잡한 애플리케이션에서는 각 계층에 명확한 데이터 모델을 제공해 하위 계층의 복잡성을 숨기는 추상화를 사용하는데, 이는 다른 그룹의 사람들이 효율적으로 협업하도록 도와준다.
- 하나의 데이터 모델을 온전히 익히는 데도 많은 노력이 필요하지만, 데이터 모델은 소프트웨어가 할 수 있는 일과 없는 일에 지대한 영향을 주므로 애플리케이션에 적합한 데이터모델을 선택하는 작업은 상당히 중요하다.
##### 관계형 모델과 문서 모델
- **관계형 모델**
  - 데이터는 관계로 구성되고 각 관계는 순서 없는 튜플 모음
  - 트랜잭션 처리나 일괄처리 등 비즈니스 데이터 처리에 근원적인 모델이다.
  - 정리된 인터페이스 뒤로 구현 세부 사항을 숨기는 게 목표이다.
  - 비즈니스 데이터 처리라는 본래 영역을 넘어 폭넓은 다양한 사용 사례에도 보편화됐다.
- **NoSQL(Not Only SQL)의 탄생**
  - 대규모 데이터셋이나 매우 높은 쓰기 처리량 달성을 관계형 데이터베이스보다 쉽게 할 수 있는 뛰어난 확장성의 필요
  - 상용 데이터베이스 제품보다 무료 오픈소스 소프트웨어의 선호
  - 관계형 모델에서 지원하지 않는 특수 질의 동작
  - 관계형 스키마의 제한에 대한 불만과 더욱 동적이고 표현력이 풍부한 데이터 모델에 대한 바람
  - 관계형 데이터베이스가 비관계형 데이터스토어와 함께 사용되는 것을 다중 저장소 지속성이라 한다.
- **객체 관계형 불일치**
  - 임피던스 불일치
    - 객체지향의 데이터를 관계형 테이블에 저장하기위해 애플리케이션 코드와 데이터베이스 모델 객체 사이에 전환 계층이 필요한데, 이런 모델 사이의 분리를 임피던스 불일치라고 한다.
  - 객체 관계형 매핑(ORM)은 보일러 플레이트의 양을 줄이지만 두 모델 간의 차이를 완벽하게 숨길 수 없다.
  - 링크드인의 이력서 같은 데이터 구조의 경우, 모든 내용을 갖추고 있는 문서라서 관계형 스키마를 사용하는 것보다 JSON 표현에 매우 적합하다.
    - JSON 표현은 다중 질의나 다중 조인을 수행하는 다중 테이블 스키마보다 더 나은 지역성을 가져서 하나의 질의로 충분하다.
- **다대일과 다대다 관계**
  - ID를 사용하면 의미 있는 정보를 한 곳에만 저장하고 그것을 참조하는 모든 것은 ID를 사용하지만, 텍스트를 직접 저장한다면 그것을 사용하는 모든 레코드에서 중복 저장하게 된다.
  - ID는 자체만으로 아무런 의미가 없기 때문에 변경할 필요가 없지만, 정보가 중복돼 있으면 모든 중복항목을 변경해야 하는데 이것은 쓰기 오버헤드와 불일치 위험이 있다.
  - 중복된 데이터를 정규화하려면 다대일 관계가 필요한데 문서 데이터베이스는 일대다 트리구조를 위해 조인이 필요하지 않지만 조인에 대한 지원이 약해 문서 모델에 적합하지 않다.
  - 데이터베이스가 조인을 지원하지 않으면 데이터베이스에 대한 다중 질의를 만들어 애플리케이션 코드에서 조인을 흉내 내야 한다.
    - 조직과 학교를 엔티티로 참조하면 각 이력서에는 언급된 조직과 학교로 연결하는 링크를 포함하거나 조직의 로고 및 추가 정보를 포함할 수 있다.
    - 한 사용자가 다른 사용자를 위해 추천서를 작성하는 기능을 넣는다면 추천서가 작성된 사용자를 참조하는 링크를 포함해야 한다.
- **문서 데이터베이스는 역사를 반복하고 있나?**
  - IBM의 정보관리 시스템은 JSON 모델과 비슷한 중첩된 레코드 트리 구조를 사용하는데, 다대다 관계 표현의 한계를 해결하기 위해 관계형 모델과 네트워크 모델이 제안됐다.
  - **네트워크 모델(코다실 모델)**
    - 계층 모델의 트리 구조에서 모든 레코드는 정확하게 하나의 부모가 있지만, 네트워크 모델에서 레코드는 다중 부모가 있을 수 있다.
    - 레코드 간 연결은 포인터와 비슷하고 레코드에 접근하는 유일한 방법은 접근 경로라는 최상위 레코드에서부터 연속된 연결 경로를 따르는 방법이 있다.
    - 코다실에서 질의는 레코드 목록을 반복해 접근 경로를 따라 데이터베이스의 끝에서 끝까지 커서를 움직여 수행하는데 다양한 관계를 모두 추적해야 한다.
    - 원하는 데이터에 대한 경로가 없다면 어려운 상황에 놓이고 접근 경로를 변경할 수 있지만 매우 어려운 일이었다.
  - **관계형 모델**
    - 알려진 모든 데이터를 배치하는 것
    - 질의 최적화기는 다양한 접근 경로를 자동으로 만든다는 점에서 차이가 있다.
    - 질의 최적화기를 한번 만들면 데이터베이스를 사용하는 모든 애플리케이션이 혜택을 받을 수 있다.
  - **문서 데이터베이스와의 비교**
    - 문서 데이터베이스는 별도의 테이블이 아닌 상위 레코드 내에 중첩된 레코드를 저장한다.
    - 관련 항목을 고유한 식별자로 참조하는데, 관계형 모델에서 외래 키라고 부르고 문서 모델에서는 문서 참조라 부른다.
- **관계형 데이터베이스와 오늘날의 문서 데이터베이스**
  - 문서 데이터 모델은 스키마 유연성, 지역성에 기인한 더 나은 성능 등의 장점이 있고 관계형 모델은 조인, 다대일, 다대다 관계를 더 잘 지원한다.
  - **어떤 데이터 모델이 애플리케이션 코드를 더 간단하게 할까?**
    - 애플리케이션 데이터가 문서와 비슷한 구조라면 문서 모델을 사용하는 것이 좋다.
    - 어떤 시점에 발생한 이벤트를 기록하는 문서 데이터베이스를 사용하는 분석 애플리케이션에선 다대다 관계가 필요하지 않다.
    - 애플리케이션에서 다대다 관계를 사용한다면 비정규화로 조인의 필요성 줄이기가 가능하지만 데이터 일관성을 유지하기 위해 추가 작업을 해야한다. 이는 복잡한 애플리케이션 코드와 나쁜 성능으로 이어질 수 있다.
    - 데이터 항목 간에 존재하는 관계 유형에 따라 애플리케이션을 더 간단하게 만드는지가 다르다.
  - **문서 모델에서의 스키마 유연성**
    - 암묵적인 스키마가 있지만 데이터베이스는 이를 강요하지 않는다. 이는 쓰기 스키마와 반대되는 읽기 스키마다.
    - 읽기 스키마는 런타임 타입 확인과 유사하고 쓰기 스키마는 정적 타입 확인과 비슷하다.
    - 접근 방식 간 차이는 데이터 타입을 변경하고자 할 때 뚜렷이 나타나는데 하나의 필드를 분리하고 싶으면 문서 데이터베이스에서는 새로운 필드를 가진 새로운 문서를 작성하고 예전 문서를 읽은 경우를 처리하는 코드만 있으면 되지만, 정적 타입의 스키마에서는 마이그레이션이 필요하다.
    - 읽기 스키마 접근 방식은 컬렉션 안의 항목이 어떤 이유로 모두 동일한 구조가 아닐 때 유리하다.
  - **질의를 위한 데이터 지역성**
    - 문서는 보통 JSON, XML로 부호화된 단일 연속 문자열이나 JSON 또는 XML의 이진 변형으로 저장된다.
    - 애플리케이션이 자주 전체 문서에 접근해야 할 때 저장소 지역성을 활용하면 성능 이점이 있다.
      - 한 번에 해당 문서의 많은 부분을 필요로 하는 경우에만 적용된다.
      - 작은 부분만 접근해도 전체 문서를 적재해야하고, 문서를 갱신할 때도 보통 전체 문서를 재작성 해야하므로 일반적으로 문서를 아주 작게 유지하면서 문서의 크기가 증가하는 쓰기를 피하라고 권장한다.
    - 지역성을 위해 관련 데이터를 함께 그룹화하는 개념이 문서 모델에만 국한되지는 않는다.
      - 구글의 스패너 데이터베이스의 부모 테이블 내 로우를 교차 배치되게끔 선언하는 스키마
      - 오라클의 다중 테이블 색인 클러스터 테이블
      - 빅테이블의 칼럼 패밀리
  - **문서 데이터베이스와 관계형 데이터베이스의 통합**
    - 관계형 데이터베이스는 JSON 문서에 대해 비슷한 수준의 지원 기능을 제공한다.
    - 문서 데이터베이스 쪽에서는 질의 언어에서 관계형 조인을 지원하고 자동으로 데이터베이스 참조를 확인하기도 한다.
    - 관계형과 문서의 혼합 모델은 미래 데이터베이스들이 가야 할 올바른 길이다.
- **데이터를 위한 질의 언어**
  - SQL은 선언형 질의 언어고 IMS와 코다실은 명령형 코드를 사용한다.
  - 명령형 언어는 특정 언어로 특정 연산을 수행하게끔 지시하는 반면 SQL 등 선언형 질의 언어는 방법이 아니라 알고자 하는 데이터의 조건과 어떻게 변환할지 지정한다.
  - 선언형 질의 언어는 데이터베이스 엔진의 상세 구현이 숨겨져 있어 질의를 변경하지 않고도 데이터베이스 시스템의 성능을 향상시킬 수 있다.
  - 만약 레코드를 옮길 경우 SQL은 특정 순서를 보장하지 않으므로 순서가 바뀌어도 상관없지만 명령어 코드이면 순서에 의존하는지 여부를 확신할 수 없다.
    - SQL이 기능적으로 제한적이지만 자동으로 최적화할 수 있는 여지를 더 많이 준다는 의미다. 
  - 선언형 언어는 병렬 실행에 적합하다.
    - 명령형 코드는 명령어를 특정 순서로 수행하게끔 지정하기 때문에 병렬처리가 매우 어렵다.
    - 선언형 언어는 결과의 패턴만 지정하기 때문에 병렬 실행으로 더 빨라질 가능성이 크다.
  - **웹에서의 선언형 질의**
    - 웹 브라우저에서 선언형 CSS 스타일을 사용하는 편이 자바스크립트에서 명령형으로 스타일을 다루기보다 훨씬 낫다.
  - **맵리듀스 질의**
    - 많은 컴퓨터에서 대량의 데이터를 처리하기 위한 프로그래밍 모델
    - 많은 문서를 대상으로 읽기 전용 질의를 수행할 때 사용
    - 선언형 질의와 명령형 질의 사이 중간쯤에 위치
    - 몽고DB의 map과 reduce는 입력으로 전달된 데이터만 사용하고 부수효과가 없어야하지만 이러한 제약 때문에 임의 순서로 어디서나 이 함수를 실행할 수 있고 장애가 발생해도 함수를 재실행 가능하다.
    - 클러스터 환경에서 맵리듀스는 저수준 프로그래밍 모델이다.
- **그래프형 데이터 모델**
  - 데이터에서 다대다 관계가 복잡해지면 그래프로 데이터 모델링을 하는 편이 좋다.
  - 정점과 간선으로 구성된다.
  - 소셜 그래프, 웹 그래프, 도로나 철도 네트워크 등의 사용사례가 있다.
  - 단일 데이터 저장소에 완전히 다른 유형의 객체를 일관성 있게 저장할 수 있다.
  - **속성 그래프**
    - 각 정점은 고유한 식별자, 유출 간선 집합, 유입 간선 집합, 속성 컬렉션으로 구성된다.
    - 각 간선은 고유한 식별자, 간선이 시작하는 정점, 간선이 끝나는 정점, 두 정점 간 관계 유형을 설명하는 레이블, 속성 컬렉션으로 구성된다.
    - 특성
      - 정점은 다른 정점과 간선으로 연결된다. 특정 유형과 관련 여부를 제한하는 스키마는 없다.
      - 정점이 주어지면 정점의 유입과 유출 간선을 효율적으로 찾을 수 있고 그래프를 순회할 수 있다. 즉 일련의 정점을 따라 앞뒤 방향으로 순회한다.
      - 다른 유형의 관계에 서로 다른 레이블을 사용하면 단일 그래프에 다른 유형의 정보를 저장하면서도 데이터 모델을 깔끔하게 유지할 수 있다.
    - 그래프는 발전성이 좋아서 애플리케이션에 기능을 추가하는 경우 애플리케이션의 데이터 구조 변경을 수용하게끔 그래프를 쉽게 확장할 수 있다.
  - **사이퍼 질의 언어**
    - 속성 그래프를 위한 선언형 질의 언어
  - **SQL의 그래프 질의**
    - 그래프 데이터를 관계형 구조로 넣어도 SQL을 사용해 질의 가능하지만, 조인 수를 고정할 수 없기 때문에 어렵다.
    - 재귀 공통 테이블 식을 사용해 표현 가능하지만 문법이 어렵다.
  - **트리플 저장소와 스파클**
    - 그래프 모델과 거의 동등하다.
    - 모든 정보를 주어/서술어/목적어 처럼 매우 간단한 세 부분 구문 형식으로 저장한다.
    - 주어는 정점, 서술어와 목적어는 주어정점에서 속성의 키 값과 동등하기도 하고 다른 정점이기도 하다.
  - **시맨틱 웹**
    - 웹 사이트는 이미 사람이 읽을 수 있는 텍스트와 그림으로 정보를 게시하고 있으니 컴퓨터가 읽게끔 기계가 판독 가능한 데이터로도 정보를 게시하는 것
    - 자원 기술 프레임워크(RDF)는 서로 다른 웹 사이트가 일관된 형식으로 데이터를 게시하기 위한 방법이고 만물 데이터베이스인 데이터 웹에 자동으로 결합할 수 있게 한다.
  - **RDF 데이터 모델**
    - 인터넷 전체의 데이터 교환을 위해 설계했다.
  - **스파클 질의 언어**
    - RDF 데이터 모델을 사용한 트리플 저장소 질의 언어다.
  - **초석: 데이터로그**
    - 서술어(주어, 목적어)로 데이터 모델을 작성한다.
- **정리**
  - 데이터를 하나의 트리로 표현하려 했지만 다대다 관계에는 적합하지 않았고 관계형 모델이 고안됐다.
  - 관계형 모델에도 적합하지 않아 문서 데이터베이스와 그래프 데이터베이스로 나뉜 NoSQL이 나왔다.
  - 각 모델은 각자의 영역에서 훌륭하고 단일 만능 솔루션이 아닌 각기 목적에 맞는 다양한 시스템을 보유해야 하는 이유이다.

#### 💡 느낀 점
- 데이터 베이스의 종류가 관계형, 문서, 그래프 등으로 나눠져 있는데 그것이 나온 이유에 대해서 배울 수 있었고, 각 데이터베이스가 필요한 상황과 적절하게 조합해서 써야한다는 것을 배웠다.
- 고수준의 추상화는 사용자를 편하게 하지만, SQL을 튜닝하는 것처럼 그 성능을 극한으로 끌어올리려면 저수준까지 공부해야한다는 것을 느꼈다.
- 선언형 언어가 내부에서 병렬처리로 성능을 올린다는 점이 인상깊었다.
- 만능솔루션은 없고 애플리케이션에 맞는 데이터베이스 선택이 중요하다는 것을 배웠다.